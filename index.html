<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RBX MARKET</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Load Config File -->
  <script src="config.js"></script>

  <style>
    :root {
      /* Dark Theme */
      --bg-primary: rgba(10, 14, 26, 0.85);
      --bg-secondary: #151923;
      --bg-card: rgba(30, 35, 49, 0.9);
      --bg-input: #2a3142;
      --text-primary: #ffffff;
      --text-secondary: #a0aec0;
      --accent-primary: #4f46e5; 
      --accent-secondary: #6366f1;
      --success: #10b981;
      --warning: #f59e0b;
      --discord-color: #5865F2; 
      --whatsapp-color: #25D366;
      --premium-color: #FFD700;
      
      /* Light Theme */
      --light-bg-primary: rgba(248, 250, 252, 0.9);
      --light-bg-secondary: #f1f5f9;
      --light-bg-card: rgba(255, 255, 255, 0.95);
      --light-bg-input: #f1f5f9;
      --light-text-primary: #1e293b;
      --light-text-secondary: #64748b;
      --light-border-color: #e2e8f0;
    }
    
    body.light {
      --bg-primary: var(--light-bg-primary);
      --bg-secondary: var(--light-bg-secondary);
      --bg-card: var(--light-bg-card);
      --bg-input: var(--light-bg-input);
      --text-primary: var(--light-text-primary);
      --text-secondary: var(--light-text-secondary);
      --border-color: var(--light-border-color);
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    html { font-size: 16px; scroll-behavior: smooth; }
    
    body {
      font-family: 'Inter', sans-serif;
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      background-color: #0a0e1a; 
      transition: background-color 0.3s ease;
    }

    #app-background {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
      background-size: cover; background-position: center;
      box-shadow: inset 0 0 100px rgba(0,0,0,0.7);
    }
    
    /* HEADER */
    .app-header {
      background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-secondary) 100%);
      padding: 0.75rem 0; border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100;
      backdrop-filter: blur(10px);
    }
    .brand-container {
      max-width: 800px; margin: 0 auto; padding: 0 1rem; display: flex; justify-content: space-between; align-items: center;
    }
    .brand { display: flex; align-items: center; gap: 0.75rem; }
    .brand-logo {
      width: 2.5rem; height: 2.5rem; background: transparent; 
      border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; color: white;
      overflow: hidden;
    }
    .brand-logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .brand-name {
      font-size: 1.5rem; font-weight: 800; background: linear-gradient(135deg, #5865F2, #eb459e);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .theme-toggle {
      background: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);
      width: 2.5rem; height: 2.5rem; border-radius: 0.75rem; cursor: pointer;
    }
    
    /* MAIN CONTAINER */
    .main-container { max-width: 800px; margin: 0 auto; padding: 1.5rem 1rem; width: 100%; }
    
    /* IMPORTANT NOTICE */
    .important-notice {
      background: rgba(245, 158, 11, 0.1); border: 1px solid #f59e0b; border-radius: 0.5rem; padding: 0.75rem;
      margin-bottom: 1rem; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 0.5rem;
    }
    .important-notice-content h4 { color: #f59e0b; margin-bottom: 0.25rem; display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; }
    .important-notice-text { font-size: 0.8rem; color: var(--text-secondary); }
    .important-notice-button {
      background: var(--discord-color); color: white; border: none; border-radius: 0.5rem;
      padding: 0.5rem 1rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; font-size: 0.8rem;
    }
    
    /* CARD */
    .calculator-card {
      background: var(--bg-card); border-radius: 0.75rem; padding: 1.25rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3); border: 1px solid var(--border-color);
    }
    .calculator-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 0.25rem;
      background: linear-gradient(90deg, var(--discord-color), var(--accent-secondary));
    }
    .card-header { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; }
    .card-icon {
      width: 2.5rem; height: 2.5rem; background: linear-gradient(135deg, var(--discord-color), #eb459e);
      border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;
    }
    
    /* TABS */
    .tabs { display: flex; background: var(--bg-input); border-radius: 0.5rem; padding: 0.25rem; gap: 0.25rem; margin-bottom: 1rem; }
    .tab-button {
      flex: 1; padding: 0.5rem 1rem; border: none; background: transparent; color: var(--text-secondary);
      border-radius: 0.25rem; cursor: pointer; font-weight: 600; transition: all 0.3s; font-size: 0.9rem;
    }
    .tab-button.active { background: var(--bg-card); color: var(--discord-color); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .tab-button:hover:not(.active) { color: var(--text-primary); }

    /* INPUT GROUP */
    .input-group { margin-bottom: 0.75rem; }
    .input-label { display: block; font-size: 0.8rem; font-weight: 500; color: var(--text-secondary); margin-bottom: 0.25rem; }
    .input-field {
      width: 100%; padding: 0.75rem 1rem; background: var(--bg-input); border: 1px solid var(--border-color);
      border-radius: 0.5rem; color: var(--text-primary); font-size: 0.95rem; transition: all 0.3s;
    }
    .input-field:focus { outline: none; border-color: var(--discord-color); box-shadow: 0 0 0 2px rgba(88, 101, 242, 0.2); }
    
    /* QUICK BUTTONS */
    .quick-buttons {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; margin-top: 0.75rem;
    }
    .quick-button {
      padding: 0.4rem; background: var(--bg-input); border: 1px solid var(--border-color);
      border-radius: 0.5rem; color: var(--text-secondary); cursor: pointer; transition: all 0.2s;
      font-size: 0.75rem; text-align: center;
    }
    .quick-button:hover { background: var(--discord-color); color: white; border-color: var(--discord-color); }
    
    /* CALCULATOR DISPLAY (Unified) */
    .calc-display-grid {
      display: grid; grid-template-columns: 1fr; gap: 0.75rem;
    }
    .calc-row { display: flex; flex-direction: column; gap: 0.25rem; }
    
    .result-box {
      background: rgba(0,0,0,0.2); padding: 0.75rem; border-radius: 0.5rem;
      border: 1px solid var(--border-color); margin-top: 0.25rem;
    }
    .result-label { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; }
    .result-value { font-size: 1.1rem; font-weight: 700; color: var(--text-primary); margin-top: 0.25rem; }
    .highlight-value { color: var(--success); font-size: 1.25rem; }

    /* LOGIN LIST STYLES */
    .login-list-container { display: none; flex-direction: column; gap: 0.75rem; }
    .login-list-container.active { display: flex; animation: fadeIn 0.3s ease; }
    .login-section-title {
      font-size: 0.8rem; font-weight: 600; color: var(--text-secondary);
      border-bottom: 1px solid var(--border-color); padding-bottom: 0.25rem; margin-bottom: 0.5rem;
      display: flex; align-items: center; gap: 0.5rem;
    }
    .login-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 0.75rem; }
    .login-item {
      background: var(--bg-input); border: 1px solid var(--border-color); border-radius: 0.5rem; padding: 0.75rem;
      display: flex; align-items: center; justify-content: space-between; cursor: pointer; transition: all 0.2s;
    }
    .login-item:hover { border-color: var(--discord-color); background: rgba(88, 101, 242, 0.05); }
    .login-item.selected { border-color: var(--success); background: rgba(16, 185, 129, 0.1); box-shadow: 0 0 0 2px var(--success); }
    .login-item-amount { font-weight: 700; font-size: 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem; }
    .login-item-tag { font-size: 0.6rem; padding: 0.1rem 0.4rem; border-radius: 0.25rem; font-weight: 600; background: var(--premium-color); color: #000; text-transform: uppercase; }
    .login-item-price { font-weight: 600; color: var(--success); font-size: 1rem; }
    
    /* ACTION BUTTONS */
    .action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 1.5rem; }
    .action-button {
      padding: 0.75rem 1rem; border: none; border-radius: 0.5rem; font-weight: 600;
      cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; font-size: 0.9rem;
    }
    .action-button.secondary { background: var(--bg-input); color: var(--text-primary); border: 1px solid var(--border-color); }
    .action-button.whatsapp-buy { background: var(--whatsapp-color); color: white; }
    .action-button.discord-buy { background: var(--discord-color); color: white; }
    .action-button.full-width { grid-column: 1 / -1; }

    /* LOGIN ACTION AREA */
    #loginActionArea { display: none; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }

    /* FOOTER */
    .footer { text-align: center; padding: 1.5rem 1rem; color: var(--text-secondary); font-size: 0.8rem; margin-top: 2rem; }

    /* TOAST */
    .toast {
      position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(100px);
      background: var(--bg-card); color: var(--text-primary); padding: 1rem 1.5rem; border-radius: 0.75rem;
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.5); border: 1px solid var(--discord-color);
      display: flex; align-items: center; gap: 0.75rem; z-index: 1000; opacity: 0; transition: all 0.4s;
    }
    .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* RESPONSIVE */
    @media (max-width: 600px) {
      .quick-buttons { grid-template-columns: repeat(3, 1fr); }
      .brand-name { font-size: 1.25rem; }
      .action-buttons { grid-template-columns: 1fr; }
      .login-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div id="app-background"></div>

  <header class="app-header">
    <div class="brand-container">
      <div class="brand">
        <div class="brand-logo">
            <!-- LOCAL FILE REFERENCE: icon.png -->
            <img src="icon.png" alt="RBX MARKET Logo">
        </div>
        <div class="brand-name">RBX MARKET</div>
      </div>
      <button class="theme-toggle" onclick="toggleTheme()"><i class="fas fa-moon" id="theme-icon"></i></button>
    </div>
  </header>

  <main class="main-container">
    <!-- Important Notice -->
    <div class="important-notice">
      <div class="important-notice-content">
        <h4><i class="fas fa-exclamation-triangle"></i> Informasi Harga</h4>
        <p class="important-notice-text">Dapatkan harga terbaik di server Discord kami. Layanan: Robux via Login, Gamepass, dan AWR.</p>
      </div>
      <button class="important-notice-button" onclick="window.open(discordLink, '_blank')">
        <i class="fab fa-discord"></i> Join Discord
      </button>
    </div>

    <div class="calculator-card">
      <div class="card-header">
        <div class="card-icon"><i class="fas fa-coins"></i></div>
        <h2 style="font-weight:700; color:var(--text-primary); font-size: 1.2rem;" id="cardTitle">ROBUX-GAMEPASS</h2>
      </div>

      <!-- TABS -->
      <div class="tabs">
        <button class="tab-button active" onclick="setMode('calc')" id="tab-calc">Gamepass</button>
        <button class="tab-button" onclick="setMode('login')" id="tab-login">Via login</button>
      </div>

      <!-- LOGIN INPUT (Selalu muncul) -->
      <div class="input-group">
        <label class="input-label"><i class="fas fa-user"></i> Username Roblox</label>
        <input type="text" class="input-field" id="robloxUser" placeholder="ketik username di sini">
      </div>

      <!-- MODE: CALCULATOR (Unified) -->
      <div id="calcContainer">
        <div class="calc-display-grid">
          <!-- KOLOM 1: JUMLAH ROBUX -->
          <div class="calc-row">
            <label class="input-label">Masukkan Jumlah Robux</label>
            <input type="text" class="input-field" id="robuxInput" placeholder="Contoh: 1000" oninput="formatInput(this, 'robux')" onkeyup="handleCalcInput('robux')">
            <div class="result-box">
              <div class="result-label">Gamepass Yg Harus Dibuat</div>
              <div class="result-value" id="calcGamepass">0</div>
            </div>
          </div>

          <!-- Removed Icon as requested -->
          <div></div>

          <!-- KOLOM 2: JUMLAH IDR -->
          <div class="calc-row">
            <label class="input-label">Masukkan Jumlah IDR</label>
            <input type="text" class="input-field" id="idrInput" placeholder="Contoh: 100.000" oninput="formatInput(this, 'idr')" onkeyup="handleCalcInput('idr')">
            <div class="result-box">
              <div class="result-label">Total Harga</div>
              <div class="result-value highlight-value" id="calcTotal">Rp 0</div>
            </div>
          </div>
        </div>

        <!-- HARGA PILIHAN CEPAT -->
        <div style="margin-top: 1rem;">
          <label class="input-label">Pilihan Cepat</label>
          <div class="quick-buttons" id="quickButtons">
            <!-- Buttons will be injected by JS -->
          </div>
        </div>
      </div>

      <!-- MODE: VIA LOGIN LIST -->
      <div id="loginContainer" class="login-list-container">
        <div class="login-section-title"><i class="fas fa-crown" style="color:var(--premium-color)"></i> Paket Premium</div>
        <div class="login-grid" id="loginPremiumList"></div>

        <div class="login-section-title" style="margin-top: 0.75rem;"><i class="fas fa-coins" style="color:var(--discord-color)"></i> Paket Reguler</div>
        <div class="login-grid" id="loginRegularList"></div>

        <div id="loginActionArea">
          <div style="text-align:center; margin-bottom:0.75rem;">
            <div style="font-size:0.8rem; color:var(--text-secondary)">Total Bayar</div>
            <div style="font-size:1.75rem; font-weight:700; color:var(--success)" id="loginTotalDisplay">Rp 0</div>
            <div style="font-size:0.9rem; color:var(--text-primary); font-weight:600" id="loginSelectedName">-</div>
          </div>
        </div>
      </div>

      <!-- ACTION BUTTONS -->
      <div class="action-buttons">
        <button class="action-button secondary full-width" onclick="resetAll()"><i class="fas fa-redo"></i> Reset</button>
        
        <!-- TOMBOL WHATSAPP -->
        <button class="action-button whatsapp-buy" onclick="buyWA()"><i class="fab fa-whatsapp"></i> Beli</button>
        
        <!-- TOMBOL DISCORD -->
        <button class="action-button discord-buy" onclick="buyDiscord()"><i class="fab fa-discord"></i> Beli</button>
      </div>
      
      <!-- INFO BOX -->
      <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(79, 70, 229, 0.1); border-left: 4px solid var(--discord-color); border-radius: 0.5rem; font-size: 0.8rem; color: var(--text-secondary);">
        <strong style="color:var(--discord-color)"><i class="fas fa-info-circle"></i> Info:</strong> 
        <span id="infoText">Klik Pilihan Cepat yang diinginkan di atas. Lalu klik tombol beli.</span>
      </div>
    </div>
  </main>

  <footer class="footer">
    <p>Â© 2023 RBX MARKET</p>
  </footer>

  <div id="toast" class="toast">
    <i class="fas fa-check-circle" style="color: var(--success); font-size: 1.5rem;"></i>
    <div>
      <div style="font-weight: 700;">Mengirim Pesan...</div>
      <div style="font-size: 0.8rem; color: var(--text-secondary);">Mohon tunggu sebentar.</div>
    </div>
  </div>

  <script>
    // --- CONFIG ---
    let mode = "calc"; // 'calc' or 'login'
    let currentRate = (typeof DEFAULT_RATE !== 'undefined') ? DEFAULT_RATE : 80;
    let discordLink = (typeof DISCORD_INVITE_LINK !== 'undefined') ? DISCORD_INVITE_LINK : "https://discord.gg/5wKzxaydh6";
    let bgImage = (typeof BACKGROUND_IMAGE !== 'undefined') ? BACKGROUND_IMAGE : "background.jpg";
    let whatsappNumber = (typeof WHATSAPP_PHONE_NUMBER !== 'undefined') ? WHATSAPP_PHONE_NUMBER : "6283821170532";

    // MENGAMBIL DATA PAKET DARI CONFIG.JS
    let loginPackages = (typeof LOGIN_PACKAGES !== 'undefined') ? LOGIN_PACKAGES : { premium: [], regular: [] };
    
    let selectedLoginPackage = null;

    if(bgImage) document.getElementById('app-background').style.backgroundImage = `url('${bgImage}')`;

    // --- INITIALIZATION ---
    document.addEventListener('DOMContentLoaded', () => {
      generateLoginList();
      generateQuickButtons();
    });

    // --- CORE FUNCTIONS ---

    function formatRupiah(angka) {
      return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(angka);
    }

    function formatInput(el, type) {
      let val = el.value.replace(/\D/g, '');
      if(val === '') { el.value = ''; el.dataset.raw = ''; return; }
      let number = parseInt(val, 10);
      
      if (type === 'idr') {
        el.value = "Rp " + number.toLocaleString('id-ID');
      } else {
        el.value = number.toLocaleString('id-ID');
      }
      el.dataset.raw = number;
    }

    function setMode(m) {
      mode = m;
      document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
      document.getElementById('tab-' + m).classList.add('active');
      
      const calcDiv = document.getElementById('calcContainer');
      const loginDiv = document.getElementById('loginContainer');
      const cardTitle = document.getElementById('cardTitle');
      const infoText = document.getElementById('infoText');

      if (m === 'calc') {
        calcDiv.style.display = 'block';
        loginDiv.classList.remove('active');
        cardTitle.innerText = "ROBUX - GAMEPASS";
        infoText.innerText = "Isi salah satu kolom di atas, sistem akan otomatis menghitung yang lain.";
      } else {
        calcDiv.style.display = 'none';
        loginDiv.classList.add('active');
        cardTitle.innerText = "ROBUX - VILOG";
        infoText.innerText = "Pilih paket yang diinginkan di atas. Lalu klik tombol beli.";
      }
    }

    // --- CALCULATOR LOGIC ---
    function handleCalcInput(source) {
      const robuxInput = document.getElementById('robuxInput');
      const idrInput = document.getElementById('idrInput');
      const displayGamepass = document.getElementById('calcGamepass');
      const displayTotal = document.getElementById('calcTotal');

      if (source === 'robux') {
        let raw = parseInt(robuxInput.dataset.raw) || 0;
        if (raw === 0) {
          idrInput.value = ""; idrInput.dataset.raw = ""; 
          displayGamepass.innerText = "0"; displayTotal.innerText = "Rp 0";
          return;
        }

        // Logic: Target -> Gamepass Price -> IDR Total
        // Formula: SellerRobux = Target / 0.7
        let sellerRobux = Math.ceil(raw / 0.7);
        let totalIDR = sellerRobux * currentRate;

        displayGamepass.innerText = sellerRobux.toLocaleString('id-ID');
        displayTotal.innerText = formatRupiah(totalIDR);

        // Update IDR Input (Don't trigger recursion)
        idrInput.value = "Rp " + totalIDR.toLocaleString('id-ID');
        idrInput.dataset.raw = totalIDR;

      } else if (source === 'idr') {
        let raw = parseInt(idrInput.dataset.raw) || 0;
        if (raw === 0) {
          robuxInput.value = ""; robuxInput.dataset.raw = "";
          displayGamepass.innerText = "0"; displayTotal.innerText = "Rp 0";
          return;
        }

        // Logic: IDR -> SellerRobux -> Target Robux
        // SellerRobux = IDR / Rate
        let sellerRobuxRaw = raw / currentRate;
        let gamepass = Math.ceil(sellerRobuxRaw);
        let targetRobux = Math.floor(sellerRobuxRaw * 0.7);

        displayGamepass.innerText = gamepass.toLocaleString('id-ID');
        displayTotal.innerText = formatRupiah(raw);

        // Update Robux Input (Don't trigger recursion)
        robuxInput.value = targetRobux.toLocaleString('id-ID');
        robuxInput.dataset.raw = targetRobux;
      }
    }

    function generateQuickButtons() {
      const container = document.getElementById('quickButtons');
      // Updated amounts as requested
      const amounts = [10000, 20000, 30000, 40000, 50000, 60000, 70000, 80000, 90000, 100000, 500000, 1000000];
      
      amounts.forEach(amt => {
        let btn = document.createElement('button');
        btn.className = 'quick-button';
        btn.innerText = formatRupiah(amt);
        btn.onclick = () => {
          // Simulate IDR input
          const idrInput = document.getElementById('idrInput');
          idrInput.value = "Rp " + amt.toLocaleString('id-ID');
          idrInput.dataset.raw = amt;
          handleCalcInput('idr');
        };
        container.appendChild(btn);
      });
    }

    // --- LOGIN LIST LOGIC ---
    function generateLoginList() {
      // Premium
      const pContainer = document.getElementById('loginPremiumList');
      loginPackages.premium.forEach(pkg => {
        let el = createLoginItem(pkg, 'premium');
        pContainer.appendChild(el);
      });
      // Regular
      const rContainer = document.getElementById('loginRegularList');
      loginPackages.regular.forEach(pkg => {
        let el = createLoginItem(pkg, 'regular');
        rContainer.appendChild(el);
      });
    }

    function createLoginItem(pkg, type) {
      let el = document.createElement('div');
      el.className = 'login-item';
      el.innerHTML = `
        <div class="login-item-amount">
          ${pkg.amount.toLocaleString('id-ID')}
          ${type === 'premium' ? '<span class="login-item-tag">+ Premium</span>' : ''}
        </div>
        <div class="login-item-price">${formatRupiah(pkg.price)}</div>
      `;
      el.onclick = () => selectLoginItem(el, pkg, type);
      return el;
    }

    function selectLoginItem(el, pkg, type) {
      document.querySelectorAll('.login-item').forEach(i => i.classList.remove('selected'));
      el.classList.add('selected');
      selectedLoginPackage = { ...pkg, type: type };
      
      const actionArea = document.getElementById('loginActionArea');
      actionArea.style.display = 'block';
      document.getElementById('loginTotalDisplay').innerText = formatRupiah(pkg.price);
      
      const name = pkg.amount.toLocaleString('id-ID') + ' Robux' + (type === 'premium' ? ' (Premium)' : '');
      document.getElementById('loginSelectedName').innerText = name;
    }

    function resetAll() {
      if (mode === 'calc') {
        document.getElementById('robuxInput').value = '';
        document.getElementById('robuxInput').dataset.raw = '';
        document.getElementById('idrInput').value = '';
        document.getElementById('idrInput').dataset.raw = '';
        document.getElementById('calcGamepass').innerText = '0';
        document.getElementById('calcTotal').innerText = 'Rp 0';
      } else {
        document.querySelectorAll('.login-item').forEach(i => i.classList.remove('selected'));
        document.getElementById('loginActionArea').style.display = 'none';
        selectedLoginPackage = null;
      }
      document.getElementById('robloxUser').value = '';
    }

    // --- BUY FUNCTIONS ---
    function showToast(platform) {
      const toast = document.getElementById('toast');
      const icon = platform === 'wa' ? 'fab fa-whatsapp' : 'fab fa-discord';
      const color = platform === 'wa' ? 'var(--whatsapp-color)' : 'var(--discord-color)';
      
      toast.innerHTML = `<i class="${icon}" style="color:${color};font-size:1.5rem"></i><div><div style="font-weight:700;">Membuka ${platform.toUpperCase()}...</div></div>`;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    function buyWA() {
      const username = document.getElementById("robloxUser").value || "Belum diisi";
      let msg = "";

      if (mode === 'login' && selectedLoginPackage) {
        msg = `Halo Admin, order Via Login.\n\nUser: ${username}\nPaket: ${selectedLoginPackage.amount} Robux ${selectedLoginPackage.type === 'premium' ? '(Premium)' : ''}\nHarga: ${formatRupiah(selectedLoginPackage.price)}\n\nMohon diproses.`;
      } else if (mode === 'calc') {
        const r = document.getElementById("robuxInput").dataset.raw || 0;
        const idr = document.getElementById("idrInput").dataset.raw || 0;
        const gp = document.getElementById("calcGamepass").innerText;
        if(r == 0 && idr == 0) return alert("Isi jumlah terlebih dahulu!");
        
        msg = `Halo Admin, order Gamepass.\n\nUser: ${username}\nTarget Robux: ${parseInt(r).toLocaleString('id-ID')}\nHarga: ${formatRupiah(idr)}\nGamepass: ${gp}\n\nMohon diproses.`;
      } else {
        return alert("Pilih paket atau isi kalkulator.");
      }

      showToast('wa');
      setTimeout(() => window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`, '_blank'), 1000);
    }

    function buyDiscord() {
      const username = document.getElementById("robloxUser").value || "Belum diisi";
      let msg = "";

      if (mode === 'login' && selectedLoginPackage) {
        msg = `ðŸ“‹ **ORDER - LOGIN**\n**User:** ${username}\n**Paket:** ${selectedLoginPackage.amount} Robux ${selectedLoginPackage.type === 'premium' ? '(Premium)' : ''}\n**Harga:** ${formatRupiah(selectedLoginPackage.price)}`;
      } else if (mode === 'calc') {
        const r = document.getElementById("robuxInput").dataset.raw || 0;
        const idr = document.getElementById("idrInput").dataset.raw || 0;
        const gp = document.getElementById("calcGamepass").innerText;
        if(r == 0 && idr == 0) return alert("Isi jumlah terlebih dahulu!");

        msg = `ðŸ“‹ **ORDER - GAMEPASS**\n**User:** ${username}\n**Target:** ${parseInt(r).toLocaleString('id-ID')} Robux\n**Harga:** ${formatRupiah(idr)}\n**Gamepass:** ${gp}`;
      } else {
        return alert("Pilih paket atau isi kalkulator.");
      }

      navigator.clipboard.writeText(msg).then(() => {
        showToast('discord');
        setTimeout(() => window.open(discordLink, '_blank'), 1500);
      });
    }

    function toggleTheme() {
      document.body.classList.toggle('light');
      document.getElementById('theme-icon').className = document.body.classList.contains('light') ? "fas fa-sun" : "fas fa-moon";
    }
  </script>
</body>
</html>
